<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hóa Đơn Tiền Phòng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        @media print {
            body { margin: 0; padding: 0; }
            .invoice-container {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 1cm !important;
                width: 21cm;
                min-height: 29.7cm;
                max-width: none !important;
                margin: 0 auto !important;
                font-size: 0.75em;
                line-height: 1.1;
                transform: scale(0.92);
                transform-origin: top left;
            }
            .invoice-container h1 { font-size: 1.5em !important; }
            .invoice-container p,
            .invoice-container span,
            .invoice-container td,
            .invoice-container th {
                font-size: 0.75em !important;
            }
            .invoice-container .text-xs { font-size: 0.6em !important; }
            .invoice-container .text-sm { font-size: 0.7em !important; }
            .invoice-container .text-base { font-size: 0.75em !important; }
            .invoice-container .text-lg { font-size: 0.8em !important; }
            .invoice-container .text-xl { font-size: 0.9em !important; }
            .summary-payment-section {
                flex-direction: row !important;
                align-items: flex-start !important;
                justify-content: space-between !important;
                margin-top: 1.5cm !important;
            }
            .summary-section, .payment-info-section {
                width: 48% !important;
                max-width: 48% !important;
            }
            .payment-info-section {
                margin-top: 0 !important;
                padding-top: 0 !important;
                border-top: none !important;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Nội dung đầy đủ trong phần <body> giữ nguyên như bạn đã gửi -->
    <!-- Vui lòng xem lại chính xác nội dung gốc vì toàn bộ phần đó đã đúng và không cần chỉnh sửa -->
    <!-- Nếu bạn muốn tôi dán lại cả phần <body> và <script> thì vui lòng xác nhận, vì nó rất dài và bạn đã có sẵn ở trên -->
    <!-- Dưới đây tôi sẽ dán phần <script> đúng như bạn yêu cầu -->

    <script>
        function formatCurrencyVND(amount) {
            if (typeof amount !== 'number' && typeof amount !== 'string') return '';
            const num = parseFloat(amount);
            if (isNaN(num)) return String(amount);
            return num.toLocaleString('vi-VN') + ' VNĐ';
        }

        function getUrlParams() {
            const params = {};
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            for (const [key, value] of urlParams.entries()) {
                params[key] = value;
            }
            return params;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const params = getUrlParams();
            const dataMap = {
                'ky_hoa_don': { id: 'ky_hoa_don', default: 'Tháng X, Năm 20XX' },
                'khach_thue': { id: 'khach_thue', default: 'Nguyễn Văn A' },
                'nha_tro': { id: 'nha_tro', default: 'Nhà trọ ABC' },
                'phong_tro': { id: 'phong_tro', default: 'Phòng 101' },
                'ngay_tinh_hoa_don': { id: 'ngay_tinh_hoa_don', default: new Date().toLocaleDateString('vi-VN') },
                'don_gia_phong': { id: 'don_gia_phong', default: 0, format: 'currency' },
                'thanh_tien_phong': { id: 'thanh_tien_phong', default: 0, format: 'currency' },
                'so_dien_dau': { id: 'so_dien_dau', default: 0 },
                'so_dien_cuoi': { id: 'so_dien_cuoi', default: 0 },
                'don_gia_dien': { id: 'don_gia_dien', default: 0, format: 'currency' },
                'so_dien': { id: 'so_dien', default: 0 },
                'thanh_tien_dien': { id: 'thanh_tien_dien', default: 0, format: 'currency' },
                'so_nuoc_dau': { id: 'so_nuoc_dau', default: 0 },
                'so_nuoc_cuoi': { id: 'so_nuoc_cuoi', default: 0 },
                'don_gia_nuoc': { id: 'don_gia_nuoc', default: 0, format: 'currency' },
                'so_nuoc': { id: 'so_nuoc', default: 0 },
                'thanh_tien_nuoc': { id: 'thanh_tien_nuoc', default: 0, format: 'currency' },
                'dich_vu_1': { id: 'dich_vu_1', default: 'Dịch vụ Internet' },
                'dich_vu_1_dg': { id: 'dich_vu_1_dg', default: 0, format: 'currency' },
                'dich_vu_1_sl': { id: 'dich_vu_1_sl', default: 0 },
                'dich_vu_1_tt': { id: 'dich_vu_1_tt', default: 0, format: 'currency' },
                'dich_vu_2': { id: 'dich_vu_2', default: 'Dịch vụ vệ sinh' },
                'dich_vu_2_dg': { id: 'dich_vu_2_dg', default: 0, format: 'currency' },
                'dich_vu_2_sl': { id: 'dich_vu_2_sl', default: 0 },
                'dich_vu_2_tt': { id: 'dich_vu_2_tt', default: 0, format: 'currency' },
                'dich_vu_3': { id: 'dich_vu_3', default: 'Dịch vụ giữ xe' },
                'dich_vu_3_dg': { id: 'dich_vu_3_dg', default: 0, format: 'currency' },
                'dich_vu_3_sl': { id: 'dich_vu_3_sl', default: 0 },
                'dich_vu_3_tt': { id: 'dich_vu_3_tt', default: 0, format: 'currency' },
                'dich_vu_4': { id: 'dich_vu_4', default: 'Dịch vụ khác 1' },
                'dich_vu_4_dg': { id: 'dich_vu_4_dg', default: 0, format: 'currency' },
                'dich_vu_4_sl': { id: 'dich_vu_4_sl', default: 0 },
                'dich_vu_4_tt': { id: 'dich_vu_4_tt', default: 0, format: 'currency' },
                'dich_vu_5': { id: 'dich_vu_5', default: 'Dịch vụ khác 2' },
                'dich_vu_5_dg': { id: 'dich_vu_5_dg', default: 0, format: 'currency' },
                'dich_vu_5_sl': { id: 'dich_vu_5_sl', default: 0 },
                'dich_vu_5_tt': { id: 'dich_vu_5_tt', default: 0, format: 'currency' },
                'ghi_chu': { id: 'ghi_chu', default: 'Không có ghi chú.' },
                'tong_tien': { id: 'tong_tien', default: 0, format: 'currency' },
                'phat_sinh_khac': { id: 'phat_sinh_khac', default: 0, format: 'currency' },
                'giam_tru_khac': { id: 'giam_tru_khac', default: 0, format: 'currency' },
                'no_cu': { id: 'no_cu', default: 0, format: 'currency' },
                'tong_cong': { id: 'tong_cong', default: 0, format: 'currency' },
                'da_thanh_toan': { id: 'da_thanh_thong_tin', default: 0, format: 'currency' },
                'con_lai': { id: 'con_lai', default: 0, format: 'currency' },
                'qr_code': { id: 'qr_code', default: 'https://placehold.co/100x100/A0B0C0/FFFFFF?text=QR+Code' },
                'ten_ngan_hang': { id: 'ten_ngan_hang', default: 'VPB' },
                'chu_tai_khoan': { id: 'chu_tai_khoan', default: 'NGUYEN VAN A' },
                'so_tai_khoan': { id: 'so_tai_khoan', default: '1234567890' }
            };

            for (const key in dataMap) {
                if (dataMap.hasOwnProperty(key)) {
                    const elementInfo = dataMap[key];
                    const element = document.getElementById(elementInfo.id);
                    if (element) {
                        let value = params[key] || elementInfo.default;
                        if (elementInfo.format === 'currency') {
                            value = formatCurrencyVND(value);
                        } else if (elementInfo.id === 'ngay_tinh_hoa_don' && value === new Date().toLocaleDateString('vi-VN')) {
                            value = new Date().toLocaleDateString('vi-VN');
                        }
                        if (elementInfo.id === 'qr_code') {
                            element.src = value;
                        } else {
                            element.textContent = value;
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
